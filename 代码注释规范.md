# 代码注释规范

## 1. 概述

本文档规定了项目中Java代码的注释规范,旨在提高代码可读性和可维护性。所有开发人员在编写代码时应遵循此规范。

## 2. 注释原则

- **必要性原则**: 注释应说明代码的意图和目的,而非简单重复代码逻辑
- **准确性原则**: 注释内容必须与代码保持一致,修改代码时同步更新注释
- **简洁性原则**: 注释应简明扼要,避免冗长和啰嗦
- **规范性原则**: 统一使用JavaDoc标准注释格式

## 3. 类级注释

### 3.1 Controller类注释

Controller类必须包含以下信息:

```java
/**
 * 功能模块名称 + 接口类型说明
 * 详细描述该Controller的主要功能和职责
 *
 * @author 作者名
 * @since 创建日期
 */
@RestController
@Api(tags = "接口分组名称")
@RequestMapping("/path")
public class XxxController {
    // 类实现
}
```

**示例**:
```java
/**
 * 管理端,分销订单管理接口
 * 提供分销订单的查询功能
 *
 * @author pikachu
 * @since 2020-03-14 23:04:56
 */
@RestController
@Api(tags = "管理端,分销订单管理接口")
@RequestMapping("/manager/distribution/order")
public class DistributionOrderManagerController {
    // 类实现
}
```

### 3.2 Service类注释

```java
/**
 * 业务模块名称 + 服务说明
 * 描述该Service的核心业务逻辑
 *
 * @author 作者名
 * @since 创建日期
 */
public interface XxxService {
    // 接口方法
}
```

### 3.3 Entity/DTO/VO类注释

```java
/**
 * 实体/数据传输对象说明
 * 描述该类的用途和包含的主要信息
 *
 * @author 作者名
 * @since 创建日期
 */
public class XxxEntity {
    // 字段定义
}
```

## 4. 方法级注释

### 4.1 公共方法注释

所有public方法必须添加JavaDoc注释,包含以下内容:

```java
/**
 * 方法功能的简要描述(一句话概括)
 * 
 * 详细说明(可选,如有复杂逻辑或特殊注意事项时添加)
 *
 * @param paramName 参数说明(说明参数的作用和含义)
 * @return 返回值说明(说明返回内容的含义)
 * @throws ExceptionType 异常说明(如果方法声明了异常)
 */
public ReturnType methodName(ParamType paramName) {
    // 方法实现
}
```

**示例**:
```java
/**
 * 分页获取分销订单列表
 *
 * @param distributionOrderSearchParams 分销订单查询参数对象,包含筛选条件和分页信息
 * @return 分页后的分销订单列表
 */
@ApiOperation(value = "分页获取分销订单")
@GetMapping(value = "/getByPage")
public ResultMessage<IPage<DistributionOrder>> getByPage(DistributionOrderSearchParams distributionOrderSearchParams) {
    return ResultUtil.data(distributionOrderService.getDistributionOrderPage(distributionOrderSearchParams));
}
```

### 4.2 复杂业务方法注释

对于包含复杂业务逻辑的方法,除JavaDoc外,还应添加行内注释说明关键步骤:

```java
/**
 * 审核分销商
 * 对分销商申请进行审核,通过或拒绝
 *
 * @param id     分销商ID
 * @param status 审核结果,PASS 通过,REFUSE 拒绝
 * @return 操作结果
 */
@PutMapping(value = "/audit/{id}")
public ResultMessage<Object> audit(@PathVariable String id, @NotNull String status) {
    // 执行审核操作
    if (distributionService.audit(id, status)) {
        return ResultUtil.success();
    } else {
        throw new ServiceException(ResultCode.DISTRIBUTION_AUDIT_ERROR);
    }
}
```

### 4.3 私有方法注释

私有方法根据复杂度选择性添加注释:
- 简单的工具方法可以不添加注释
- 包含复杂逻辑的私有方法应添加简要注释

```java
/**
 * 校验订单状态
 */
private boolean validateOrderStatus(Order order) {
    // 实现逻辑
}
```

## 5. 字段注释

### 5.1 成员变量注释

```java
/**
 * 分销订单服务
 */
@Autowired
private DistributionOrderService distributionOrderService;

/**
 * 用户ID
 */
private String userId;

/**
 * 订单状态: 0-待支付, 1-已支付, 2-已取消
 */
private Integer orderStatus;
```

### 5.2 常量注释

常量必须添加注释说明其含义和用途:

```java
/**
 * 默认分页大小
 */
public static final int DEFAULT_PAGE_SIZE = 10;

/**
 * 订单超时时间(分钟)
 */
private static final int ORDER_TIMEOUT_MINUTES = 30;
```

## 6. 行内注释

### 6.1 使用场景

以下情况需要添加行内注释:
- 复杂的业务逻辑
- 不直观的算法实现
- 重要的判断条件
- 需要特别说明的代码段

### 6.2 注释风格

```java
// 单行注释使用双斜杠,注释内容前后各空一格
int result = calculate();

// 查询用户信息
User user = userService.getById(userId);

// 校验用户权限
if (!hasPermission(user)) {
    throw new ServiceException("无权限访问");
}

/*
 * 多行注释用于说明较复杂的逻辑
 * 1. 首先查询订单信息
 * 2. 然后校验订单状态
 * 3. 最后更新库存
 */
Order order = orderService.getById(orderId);
```

## 7. 特殊注释标记

在代码中使用特殊标记来标识需要注意的内容:

```java
// TODO: 待实现的功能
// FIXME: 需要修复的问题
// NOTE: 需要注意的事项
// OPTIMIZE: 可以优化的代码
```

**示例**:
```java
// TODO: 添加缓存机制提升查询性能
public List<Product> getProducts() {
    return productMapper.selectAll();
}

// FIXME: 并发情况下可能存在库存超卖问题
public void reduceStock(String productId, int quantity) {
    // 库存扣减逻辑
}
```

## 8. 注释禁忌

### 8.1 避免无意义的注释

❌ **错误示例**:
```java
// 获取用户ID
String userId = user.getId();

// i自增
i++;
```

### 8.2 避免过时的注释

代码修改后必须同步更新注释,避免注释与代码不一致。

❌ **错误示例**:
```java
/**
 * 获取用户列表
 */
public List<Order> getOrders() {  // 方法返回订单列表,但注释说的是用户列表
    return orderService.list();
}
```

### 8.3 避免注释掉的代码

不要提交被注释掉的代码,应该直接删除。版本控制系统会保留历史代码。

❌ **错误示例**:
```java
public void processOrder(Order order) {
    // oldMethod(order);
    // System.out.println("debug info");
    newMethod(order);
}
```

### 8.4 避免中英文混用

注释统一使用中文,专业术语可以保留英文。

✅ **正确示例**:
```java
/**
 * 通过JWT token验证用户身份
 */
```

❌ **错误示例**:
```java
/**
 * Verify用户identity通过JWT令牌
 */
```

## 9. Swagger注解与注释配合

在Controller层,JavaDoc注释与Swagger注解配合使用:

```java
/**
 * 审核分销商
 * 对分销商申请进行审核,通过或拒绝
 *
 * @param id     分销商ID
 * @param status 审核结果,PASS 通过,REFUSE 拒绝
 * @return 操作结果
 */
@ApiOperation(value = "审核分销商")
@ApiImplicitParams({
    @ApiImplicitParam(name = "id", value = "分销商id", required = true, paramType = "path", dataType = "String"),
    @ApiImplicitParam(name = "status", value = "审核结果,PASS 通过  REFUSE 拒绝", required = true, paramType = "query", dataType = "String")
})
@PutMapping(value = "/audit/{id}")
public ResultMessage<Object> audit(@PathVariable String id, @NotNull String status) {
    // 执行审核操作
    if (distributionService.audit(id, status)) {
        return ResultUtil.success();
    } else {
        throw new ServiceException(ResultCode.DISTRIBUTION_AUDIT_ERROR);
    }
}
```

## 10. 注释检查清单

在代码提交前,请检查以下内容:

- [ ] 所有public类都有类级JavaDoc注释
- [ ] 所有public方法都有完整的JavaDoc注释
- [ ] 复杂业务逻辑添加了行内注释
- [ ] 所有字段都有说明性注释
- [ ] 常量定义了清晰的注释
- [ ] 注释内容与代码逻辑一致
- [ ] 没有注释掉的废弃代码
- [ ] 没有无意义的冗余注释
- [ ] 特殊逻辑添加了TODO/FIXME等标记

## 11. 注释示例参考

完整的Controller类注释示例请参考:
- `manager-api/src/main/java/cn/lili/controller/distribution/DistributionOrderManagerController.java`
- `manager-api/src/main/java/cn/lili/controller/distribution/DistributionManagerController.java`
- `manager-api/src/main/java/cn/lili/controller/distribution/DistributionGoodsManagerController.java`
- `manager-api/src/main/java/cn/lili/controller/distribution/DistributionCashManagerController.java`

---

**文档版本**: v1.0  
**最后更新**: 2026-01-11  
**维护者**: 开发团队
